{% extends 'dashboard/seller/base.html' %}
{% load static %}
{% load math_filters %}

{% block title %}My Properties - BHOOSPARSH Seller Dashboard{% endblock %}

{% block extra_css %}
<style>
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes pulse-glow {
        0%, 100% {
            box-shadow: 0 0 0 0 rgba(14, 104, 185, 0.3);
        }
        50% {
            box-shadow: 0 0 0 10px rgba(14, 104, 185, 0);
        }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .card-animate {
        animation: slideIn 0.6s ease-out forwards;
        opacity: 0;
    }

    .pulse-button {
        animation: pulse-glow 2s infinite;
    }

    .stats-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }

    .property-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(229, 231, 235, 0.5);
    }

    .property-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        border-color: #0E68B9;
    }

    .stagger-1 { animation-delay: 0.1s; }
    .stagger-2 { animation-delay: 0.2s; }
    .stagger-3 { animation-delay: 0.3s; }
    .stagger-4 { animation-delay: 0.4s; }
    .stagger-5 { animation-delay: 0.5s; }

    /* Property specific styles */
    .property-image {
        height: 200px;
        object-fit: cover;
        border-radius: 12px 12px 0 0;
    }

    .bulk-select-item {
        width: 20px;
        height: 20px;
        cursor: pointer;
    }

    .bulk-select-item:checked {
        background-color: #0E68B9;
        border-color: #0E68B9;
    }

    .status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
    }

    .status-active {
        background: #10B981;
        color: white;
    }

    .status-draft {
        background: #6B7280;
        color: white;
    }

    .status-pending {
        background: #F59E0B;
        color: white;
    }

    .status-expired {
        background: #EF4444;
        color: white;
    }

    .featured-badge {
        background: #0E68B9;
        color: white;
        animation: pulse-glow 2s infinite;
    }

    /* Filter form styles */
    .filter-select {
        background: transparent;
        border: 1px solid rgba(229, 231, 235, 0.5);
        border-radius: 8px;
        padding: 10px 12px;
        width: 100%;
        color: #374151;
    }

    .dark .filter-select {
        background: #374151;
        border-color: #4B5563;
        color: #D1D5DB;
    }

    .filter-select:focus {
        outline: none;
        border-color: #0E68B9;
        box-shadow: 0 0 0 3px rgba(14, 104, 185, 0.1);
    }

    /* Custom progress bar */
    .custom-progress {
        height: 8px;
        border-radius: 4px;
        overflow: hidden;
        background-color: #e5e7eb;
    }

    .dark .custom-progress {
        background-color: #374151;
    }

    .custom-progress-bar {
        height: 100%;
        transition: width 1s ease-in-out;
        background: linear-gradient(90deg, #0E68B9, #1E90FF);
    }

    /* Hover effects */
    .hover-lift {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-lift:hover {
        transform: translateY(-2px);
    }

    .hover-grow {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-grow:hover {
        transform: scale(1.02);
    }

    /* Modal styles */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 100;
        backdrop-filter: blur(4px);
        animation: fadeIn 0.3s ease-out;
    }

    .modal-overlay.active {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .modal-content {
        background: white;
        border-radius: 16px;
        padding: 24px;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
    }

    .dark .modal-content {
        background: #1f2937;
    }

    /* Loading skeleton */
    .loading-skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    .dark .loading-skeleton {
        background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* BHOOSPARSH Branding */
    .brand-gradient {
        background: linear-gradient(135deg, #0E68B9, #1E90FF);
    }

    .text-brand-blue {
        color: #0E68B9;
    }

    .border-brand-blue {
        border-color: #0E68B9;
    }
</style>
{% endblock %}

{% block header_title %}
<h1 class="text-xl font-bold text-gray-900 dark:text-white">My Properties</h1>
<p class="text-sm text-gray-600 dark:text-gray-400">Manage and track your property listings on BHOOSPARSH</p>
{% endblock %}

{% block header_buttons %}
<button onclick="openBulkActions()" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition flex items-center gap-2 hover-lift">
    <i class="fas fa-layer-group"></i>
    <span>Bulk Actions</span>
</button>
<a href="{% url 'seller_property_create' %}" class="px-4 py-2 bg-99acres-orange text-white rounded-lg hover:bg-orange-600 transition flex items-center gap-2 hover-lift">
    <i class="fas fa-plus"></i>
    <span>Post Property</span>
</a>
{% endblock %}

{% block content %}
<!-- Stats Cards -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
    <div class="stats-card card-animate stagger-1">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm h-full hover-grow">
            <div class="flex items-center">
                <div class="rounded-full bg-blue-100 dark:bg-blue-900 p-3 mr-4 hover-lift">
                    <i class="fas fa-check-circle text-blue-600 dark:text-blue-400 text-xl"></i>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{ active_count }}</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Active Properties</p>
                </div>
            </div>
            <div class="mt-3">
                <div class="flex justify-between text-xs text-gray-500">
                    <span>{{ draft_count }} drafts</span>
                    <span>{{ expiring_count }} expiring</span>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-card card-animate stagger-2">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm h-full hover-grow">
            <div class="flex items-center">
                <div class="rounded-full bg-yellow-100 dark:bg-yellow-900 p-3 mr-4 hover-lift">
                    <i class="fas fa-edit text-yellow-600 dark:text-yellow-400 text-xl"></i>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{ draft_count }}</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Drafts</p>
                </div>
            </div>
            <div class="mt-3">
                <div class="flex items-center text-xs text-yellow-600">
                    <i class="fas fa-exclamation-circle mr-1"></i>
                    <span>Complete to publish</span>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-card card-animate stagger-3">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm h-full hover-grow">
            <div class="flex items-center">
                <div class="rounded-full bg-red-100 dark:bg-red-900 p-3 mr-4 hover-lift">
                    <i class="fas fa-clock text-red-600 dark:text-red-400 text-xl"></i>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{ expiring_count }}</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Expiring Soon</p>
                </div>
            </div>
            <div class="mt-3">
                <div class="flex items-center text-xs text-red-600">
                    <i class="fas fa-exclamation-triangle mr-1"></i>
                    <span>Renew now</span>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-card card-animate stagger-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm h-full hover-grow">
            <div class="flex items-center">
                <div class="rounded-full bg-green-100 dark:bg-green-900 p-3 mr-4 hover-lift">
                    <i class="fas fa-home text-green-600 dark:text-green-400 text-xl"></i>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{ total_properties }}</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Total Properties</p>
                </div>
            </div>
            <div class="mt-3">
                <div class="flex items-center text-xs text-green-600">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>Manage all listings</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Filter Bar -->
<div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6 mb-6 hover-grow card-animate">
    <form method="get" id="filterForm" class="space-y-4 md:space-y-0 md:grid md:grid-cols-4 md:gap-4">
        <div>
            <label for="status" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
            <select id="status" name="status" class="filter-select">
                <option value="">All Status</option>
                <option value="active" {% if request.GET.status == 'active' %}selected{% endif %}>Active</option>
                <option value="draft" {% if request.GET.status == 'draft' %}selected{% endif %}>Draft</option>
                <option value="pending" {% if request.GET.status == 'pending' %}selected{% endif %}>Pending</option>
                <option value="expired" {% if request.GET.status == 'expired' %}selected{% endif %}>Expired</option>
            </select>
        </div>
        <div>
            <label for="property_type" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
            <select id="property_type" name="property_type" class="filter-select">
                <option value="">All Types</option>
                <option value="house" {% if request.GET.property_type == 'house' %}selected{% endif %}>House</option>
                <option value="apartment" {% if request.GET.property_type == 'apartment' %}selected{% endif %}>Apartment</option>
                <option value="villa" {% if request.GET.property_type == 'villa' %}selected{% endif %}>Villa</option>
                <option value="commercial" {% if request.GET.property_type == 'commercial' %}selected{% endif %}>Commercial</option>
            </select>
        </div>
        <div>
            <label for="city" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">City</label>
            <select id="city" name="city" class="filter-select">
                <option value="">All Cities</option>
                <option value="mumbai" {% if request.GET.city == 'mumbai' %}selected{% endif %}>Mumbai</option>
                <option value="delhi" {% if request.GET.city == 'delhi' %}selected{% endif %}>Delhi</option>
                <option value="bangalore" {% if request.GET.city == 'bangalore' %}selected{% endif %}>Bangalore</option>
                <option value="hyderabad" {% if request.GET.city == 'hyderabad' %}selected{% endif %}>Hyderabad</option>
            </select>
        </div>
        <div>
            <label for="sort_by" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Sort By</label>
            <select id="sort_by" name="sort_by" class="filter-select">
                <option value="newest" {% if request.GET.sort_by == 'newest' %}selected{% endif %}>Newest First</option>
                <option value="oldest" {% if request.GET.sort_by == 'oldest' %}selected{% endif %}>Oldest First</option>
                <option value="price_high" {% if request.GET.sort_by == 'price_high' %}selected{% endif %}>Price: High to Low</option>
                <option value="price_low" {% if request.GET.sort_by == 'price_low' %}selected{% endif %}>Price: Low to High</option>
                <option value="views" {% if request.GET.sort_by == 'views' %}selected{% endif %}>Most Viewed</option>
            </select>
        </div>
        <div class="md:col-span-4 flex justify-between pt-4">
            <button type="submit" class="px-6 py-2 bg-99acres-blue text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 hover-lift">
                <i class="fas fa-filter"></i>
                Apply Filters
            </button>
            <a href="{% url 'seller_properties' %}" class="px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition flex items-center gap-2 hover-lift">
                <i class="fas fa-redo"></i>
                Reset Filters
            </a>
        </div>
    </form>
</div>

<!-- Bulk Actions Bar -->
<div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-4 mb-6 card-animate">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div class="flex items-center gap-3">
            <div class="form-check">
                <input class="form-check-input bulk-select-all w-5 h-5 rounded border-gray-300 dark:border-gray-600 focus:ring-99acres-blue" type="checkbox" id="selectAll">
                <label class="form-check-label ml-2 text-sm text-gray-700 dark:text-gray-300" for="selectAll">
                    Select All ({{ properties.paginator.count|default:0 }} properties)
                </label>
            </div>
        </div>
        
        <div class="flex items-center gap-2">
            <select class="filter-select" style="width: auto;" id="bulkActionSelect">
                <option value="">Bulk Actions</option>
                <option value="boost">Boost Selected</option>
                <option value="renew">Renew Selected</option>
                <option value="pause">Pause Selected</option>
                <option value="activate">Activate Selected</option>
                <option value="archive">Archive Selected</option>
            </select>
            <button class="px-4 py-2 bg-99acres-blue text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 hover-lift" id="applyBulkAction">
                <i class="fas fa-play"></i>
                Apply
            </button>
        </div>
    </div>
</div>

<!-- Properties Grid -->
{% if properties %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    {% for property in properties %}
    <div class="property-card bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-sm card-animate">
        <!-- Property Image -->
        <div class="relative">
            {% if property.primary_image %}
            <img src="{{ property.primary_image.url }}" class="w-full h-48 object-cover property-image" alt="{{ property.title }}">
            {% else %}
            <div class="w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center property-image">
                <i class="fas fa-home text-gray-400 dark:text-gray-500 text-5xl"></i>
            </div>
            {% endif %}
            
            <!-- Status Badges -->
            <div class="absolute top-3 left-3 flex flex-col gap-2">
                {% if property.is_featured %}
                <span class="featured-badge status-badge text-xs flex items-center gap-1">
                    <i class="fas fa-star"></i> Featured
                </span>
                {% endif %}
                {% if property.is_verified %}
                <span class="bg-green-500 status-badge text-xs flex items-center gap-1">
                    <i class="fas fa-check-circle"></i> Verified
                </span>
                {% endif %}
            </div>
            
            <!-- Performance Badge -->
            <div class="absolute top-3 right-3">
                <span class="bg-purple-600 status-badge text-white text-xs">
                    <i class="fas fa-eye mr-1"></i>{{ property.view_count|default:0 }} views
                </span>
            </div>
            
            <!-- Checkbox for bulk selection -->
            <div class="absolute bottom-3 left-3">
                <input class="bulk-select-item w-5 h-5 rounded border-gray-300 dark:border-gray-600 focus:ring-99acres-blue" type="checkbox" value="{{ property.id }}" id="property_{{ property.id }}">
            </div>
        </div>
        
        <div class="p-5">
            <h3 class="font-bold text-lg text-gray-900 dark:text-white mb-2">
                <a href="{% url 'seller_property_detail' property.slug %}" class="hover:text-99acres-blue transition">
                    {{ property.title|truncatechars:40 }}
                </a>
            </h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3 flex items-center gap-1">
                <i class="fas fa-map-marker-alt"></i>
                {{ property.city }}, {{ property.locality }}
            </p>
            
            <div class="flex justify-between items-center mb-4">
                <span class="text-xl font-bold text-gray-900 dark:text-white">â‚¹{{ property.price|floatformat:0 }}</span>
                <span class="status-badge {% if property.status == 'active' %}status-active{% elif property.status == 'draft' %}status-draft{% elif property.status == 'pending' %}status-pending{% elif property.status == 'expired' %}status-expired{% endif %}">
                    {{ property.get_status_display }}
                </span>
            </div>
            
            <div class="grid grid-cols-4 gap-2 mb-4 text-center">
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-2 hover-lift">
                    <i class="fas fa-bed text-gray-600 dark:text-gray-400"></i>
                    <p class="text-sm font-medium mt-1">{{ property.bedrooms|default:"-" }}</p>
                    <p class="text-xs text-gray-500">Beds</p>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-2 hover-lift">
                    <i class="fas fa-bath text-gray-600 dark:text-gray-400"></i>
                    <p class="text-sm font-medium mt-1">{{ property.bathrooms|default:"-" }}</p>
                    <p class="text-xs text-gray-500">Baths</p>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-2 hover-lift">
                    <i class="fas fa-ruler-combined text-gray-600 dark:text-gray-400"></i>
                    <p class="text-sm font-medium mt-1">{{ property.area|default:"-" }}</p>
                    <p class="text-xs text-gray-500">{{ property.area_unit|default:"Sq. Ft." }}</p>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-2 hover-lift">
                    <i class="fas fa-car text-gray-600 dark:text-gray-400"></i>
                    <p class="text-sm font-medium mt-1">{{ property.parking|default:"-" }}</p>
                    <p class="text-xs text-gray-500">Parking</p>
                </div>
            </div>
            
            <!-- Performance Stats -->
            <div class="flex justify-between mb-4 text-sm">
                <div class="flex items-center gap-1">
                    <i class="fas fa-eye text-gray-400"></i>
                    <span>{{ property.view_count|default:0 }} views</span>
                </div>
                <div class="flex items-center gap-1">
                    <i class="fas fa-phone-alt text-gray-400"></i>
                    <span>{{ property.inquiry_count|default:0 }} inquiries</span>
                </div>
                <div class="flex items-center gap-1">
                    <i class="fas fa-chart-line text-gray-400"></i>
                    <span>{{ property.performance_score|default:"0" }}%</span>
                </div>
            </div>
            
            <!-- Days Remaining -->
            {% if property.days_remaining and property.days_remaining > 0 %}
            <div class="mb-3">
                <div class="flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1">
                    <span>Expires in {{ property.days_remaining }} days</span>
                    <span>{{ property.days_remaining }}%</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                    <div class="h-2 rounded-full custom-progress-bar" 
                         style="width: {% if property.days_remaining > 100 %}100{% else %}{{ property.days_remaining }}{% endif %}%">
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        
        <div class="px-5 pb-5">
            <div class="flex justify-between items-center">
                <div class="flex gap-2">
                    <a href="{% url 'seller_property_detail' property.slug %}" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition hover-lift" title="View">
                        <i class="fas fa-eye"></i>
                    </a>
                    <a href="{% url 'seller_property_edit' property.slug %}" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition hover-lift" title="Edit">
                        <i class="fas fa-edit"></i>
                    </a>
                    {% if property.status == 'active' %}
                    <a href="{% url 'seller_property_pause' property.slug %}" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition hover-lift" title="Pause">
                        <i class="fas fa-pause"></i>
                    </a>
                    {% else %}
                    <a href="{% url 'seller_property_activate' property.slug %}" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition hover-lift" title="Activate">
                        <i class="fas fa-play"></i>
                    </a>
                    {% endif %}
                    <a href="{% url 'seller_property_delete' property.slug %}" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition hover-lift" title="Delete" onclick="return confirm('Are you sure you want to archive this property?')">
                        <i class="fas fa-trash"></i>
                    </a>
                </div>
                
                {% if property.is_featured %}
                <span class="featured-badge status-badge text-xs flex items-center gap-1">
                    <i class="fas fa-rocket"></i> Featured
                </span>
                {% else %}
                <a href="{% url 'seller_property_feature' property.slug %}" class="p-2 bg-99acres-orange text-white rounded-lg hover:bg-orange-600 transition hover-lift" title="Boost">
                    <i class="fas fa-rocket"></i>
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Pagination -->
{% if properties.has_other_pages %}
<div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-4 card-animate">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="text-sm text-gray-600 dark:text-gray-400">
            Showing {{ properties.start_index }} to {{ properties.end_index }} of {{ properties.paginator.count }} properties
        </div>
        <nav class="flex items-center gap-1">
            {% if properties.has_previous %}
            <a href="?page={{ properties.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
               class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition hover-lift">
                <i class="fas fa-chevron-left"></i>
            </a>
            {% endif %}
            
            {% for num in properties.paginator.page_range %}
                {% if properties.number == num %}
                <span class="px-4 py-2 bg-99acres-blue text-white rounded-lg">
                    {{ num }}
                </span>
                {% elif num > properties.number|add:'-3' and num < properties.number|add:'3' %}
                <a href="?page={{ num }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                   class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition hover-lift">
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}
            
            {% if properties.has_next %}
            <a href="?page={{ properties.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
               class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition hover-lift">
                <i class="fas fa-chevron-right"></i>
            </a>
            {% endif %}
        </nav>
    </div>
</div>
{% endif %}

{% else %}
<!-- Empty State -->
<div class="text-center py-12 card-animate">
    <div class="mb-6">
        <div class="w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center mx-auto">
            <i class="fas fa-home text-gray-400 dark:text-gray-500 text-4xl"></i>
        </div>
    </div>
    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">No Properties Found</h3>
    <p class="text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto">
        {% if request.GET %}
        No properties match your current filters. Try adjusting your search criteria.
        {% else %}
        You haven't listed any properties yet on BHOOSPARSH. Start by posting your first property!
        {% endif %}
    </p>
    <a href="{% url 'seller_property_create' %}" class="inline-flex items-center gap-2 px-6 py-3 bg-99acres-orange text-white rounded-lg hover:bg-orange-600 transition hover-lift">
        <i class="fas fa-plus"></i>
        Post Your First Property
    </a>
</div>
{% endif %}

<!-- Bulk Action Modal -->
<div id="bulkActionModal" class="modal-overlay">
    <div class="modal-content">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-lg font-bold text-gray-900 dark:text-white">Confirm Bulk Action</h3>
            <button onclick="closeModal('bulkActionModal')" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="space-y-4">
            <p id="bulkActionMessage" class="text-gray-700 dark:text-gray-300">
                Are you sure you want to perform this action on <span id="selectedCount" class="font-bold">0</span> properties?
            </p>
            <div id="bulkActionDetails" class="hidden">
                <!-- Additional details for specific actions -->
            </div>
        </div>
        <div class="flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
            <button onclick="closeModal('bulkActionModal')" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition">
                Cancel
            </button>
            <button onclick="confirmBulkAction()" class="px-4 py-2 bg-99acres-blue text-white rounded-lg hover:bg-blue-700 transition">
                Confirm Action
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize animations
        const cards = document.querySelectorAll('.card-animate');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.opacity = '1';
            }, 100);
        });

        // Initialize bulk actions
        initBulkActions();
        
        // Initialize filter form
        initFilterForm();
        
        // Property card hover effects
        initPropertyCards();
    });

    function initBulkActions() {
        // Select all checkbox
        const selectAllCheckbox = document.getElementById('selectAll');
        const propertyCheckboxes = document.querySelectorAll('.bulk-select-item');
        
        if (selectAllCheckbox) {
            selectAllCheckbox.addEventListener('change', function() {
                const isChecked = this.checked;
                propertyCheckboxes.forEach(checkbox => {
                    checkbox.checked = isChecked;
                });
                updateSelectedCount();
            });
        }
        
        // Individual property checkboxes
        propertyCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateSelectedCount);
        });
        
        // Apply bulk action button
        const applyBulkActionBtn = document.getElementById('applyBulkAction');
        if (applyBulkActionBtn) {
            applyBulkActionBtn.addEventListener('click', openBulkActionModal);
        }
    }

    function updateSelectedCount() {
        const selectedCheckboxes = document.querySelectorAll('.bulk-select-item:checked');
        const selectedCount = selectedCheckboxes.length;
        document.getElementById('selectedCount').textContent = selectedCount;
    }

    function openBulkActionModal() {
        const selectedCheckboxes = document.querySelectorAll('.bulk-select-item:checked');
        const selectedCount = selectedCheckboxes.length;
        const actionSelect = document.getElementById('bulkActionSelect');
        const selectedAction = actionSelect.value;
        
        if (selectedCount === 0) {
            showToast('Please select at least one property.', 'error');
            return;
        }
        
        if (!selectedAction) {
            showToast('Please select an action to perform.', 'error');
            return;
        }
        
        // Update modal content based on action
        let actionText = '';
        let actionDetails = '';
        
        switch(selectedAction) {
            case 'boost':
                actionText = 'Boost Selected Properties';
                actionDetails = 'This will boost the visibility of selected properties for 7 days.';
                break;
            case 'renew':
                actionText = 'Renew Selected Properties';
                actionDetails = 'This will renew the selected properties for another 30 days.';
                break;
            case 'pause':
                actionText = 'Pause Selected Properties';
                actionDetails = 'Selected properties will be temporarily hidden from search results.';
                break;
            case 'activate':
                actionText = 'Activate Selected Properties';
                actionDetails = 'Selected properties will be made visible to potential buyers.';
                break;
            case 'archive':
                actionText = 'Archive Selected Properties';
                actionDetails = 'Selected properties will be moved to archive. They can be restored later.';
                break;
        }
        
        document.querySelector('#bulkActionModal h3').textContent = actionText;
        document.getElementById('bulkActionMessage').innerHTML = `
            Are you sure you want to ${actionText.toLowerCase()} <span id="selectedCount" class="font-bold">${selectedCount}</span> properties?
        `;
        
        const detailsDiv = document.getElementById('bulkActionDetails');
        if (actionDetails) {
            detailsDiv.innerHTML = `<p class="text-sm text-gray-600 dark:text-gray-400">${actionDetails}</p>`;
            detailsDiv.classList.remove('hidden');
        } else {
            detailsDiv.classList.add('hidden');
        }
        
        // Show modal
        const modal = document.getElementById('bulkActionModal');
        modal.classList.add('active');
    }

    function confirmBulkAction() {
        const actionSelect = document.getElementById('bulkActionSelect');
        const selectedAction = actionSelect.value;
        const selectedCheckboxes = document.querySelectorAll('.bulk-select-item:checked');
        const propertyIds = Array.from(selectedCheckboxes).map(cb => cb.value);
        
        showToast(`Processing ${selectedAction} action for ${propertyIds.length} properties...`, 'info');
        
        // Prepare data for AJAX request
        const csrfToken = getCookie('csrftoken');
        const formData = new FormData();
        formData.append('action', selectedAction);
        formData.append('property_ids', propertyIds.join(','));
        
        // Simulate API call (replace with actual AJAX call)
        setTimeout(() => {
            // In production, use actual AJAX call:
            // fetch('{% url "seller_ajax_bulk_action" %}', {
            //     method: 'POST',
            //     headers: {
            //         'X-CSRFToken': csrfToken,
            //     },
            //     body: formData
            // })
            // .then(response => response.json())
            // .then(data => {
            //     if (data.success) {
            //         showToast(data.message, 'success');
            //         setTimeout(() => {
            //             location.reload();
            //         }, 2000);
            //     } else {
            //         showToast(data.error, 'error');
            //     }
            // })
            // .catch(error => {
            //     showToast('An error occurred. Please try again.', 'error');
            // });
            
            showToast(`Successfully processed ${propertyIds.length} properties!`, 'success');
            closeModal('bulkActionModal');
            
            // Clear selections
            document.getElementById('selectAll').checked = false;
            document.querySelectorAll('.bulk-select-item').forEach(cb => cb.checked = false);
            document.getElementById('bulkActionSelect').value = '';
        }, 1000);
    }

    function initFilterForm() {
        // Auto-submit form when filter changes (optional)
        // const filterSelects = document.querySelectorAll('#filterForm select');
        // filterSelects.forEach(select => {
        //     select.addEventListener('change', function() {
        //         document.getElementById('filterForm').submit();
        //     });
        // });
        
        // Add visual feedback on form submission
        const filterForm = document.getElementById('filterForm');
        if (filterForm) {
            filterForm.addEventListener('submit', function(e) {
                const submitBtn = this.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Applying...';
                    submitBtn.disabled = true;
                }
            });
        }
    }

    function initPropertyCards() {
        // Add hover effects to property cards
        const propertyCards = document.querySelectorAll('.property-card');
        propertyCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px)';
                this.style.boxShadow = '0 25px 50px rgba(0, 0, 0, 0.15)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '';
            });
        });
    }

    function openBulkActions() {
        showToast('Open bulk actions panel', 'info');
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.remove('active');
    }

    function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `p-4 rounded-lg shadow-lg flex items-center gap-3 ${
            type === 'success' ? 'bg-green-500 text-white' :
            type === 'error' ? 'bg-red-500 text-white' :
            type === 'warning' ? 'bg-yellow-500 text-white' :
            'bg-blue-500 text-white'
        }`;
        
        const icon = type === 'success' ? 'fa-check-circle' : 
                     type === 'error' ? 'fa-exclamation-circle' : 
                     type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
        
        toast.innerHTML = `
            <i class="fas ${icon}"></i>
            <span>${message}</span>
            <button onclick="this.parentElement.remove()" class="ml-auto">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        const container = document.getElementById('toast-container');
        container.appendChild(toast);
        
        setTimeout(() => {
            if (toast.parentElement) {
                toast.remove();
            }
        }, 3000);
    }

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    // Close modal when clicking outside
    document.addEventListener('click', function(event) {
        const modals = document.querySelectorAll('.modal-overlay');
        modals.forEach(modal => {
            if (event.target === modal) {
                modal.classList.remove('active');
            }
        });
    });

    // Close modal with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeModal('bulkActionModal');
        }
    });
</script>
{% endblock %}